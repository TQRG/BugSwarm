language: java

sudo: false

# Triggers an update of the OracleJDK distribution. Travis is currently running v8u31 which
# exposes problems with the instrumentation of invokedynamic call sites.
addons:
  apt:
    packages:
      - oracle-java8-installer

branches:
  only:
    - master

jdk:
  - oraclejdk8

matrix:
  include:
    - jdk: oraclejdk7
      env: TARGET=-Dnet.bytebuddy.travis=true
    - jdk: openjdk6
      env: TARGET=-Dnet.bytebuddy.travis=true
    - jdk: oraclejdk8
      env: TARGET=-Pjava8 -Dnet.bytebuddy.travis=true
    - jdk: oraclejdk7
      env: TARGET=-Pjava7 -Dnet.bytebuddy.travis=true

script: mvn verify $TARGET -Pintegration

after_success:
  - mvn clean cobertura:cobertura coveralls:report -Pintegration
