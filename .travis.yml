addons: {firefox: latest}
after_success: [./manage.sh py_test_coverage, codecov]
before_install: ['export DISPLAY=:99.0', sh -e /etc/init.d/xvfb start, npm install
    less@2.7 less-plugin-clean-css grunt-cli, 'export PATH=`pwd`/node_modules/.bin:$PATH',
  ./manage.sh install_geckodriver ~/drivers, 'export PATH=~/drivers:$PATH']
cache:
- pip
- npm
- directories: [$HOME/.cache/pip]
dist: trusty
group: stable
install: [./manage.sh npm_packages, ./manage.sh update_dev_packages, pip install codecov==2.0.9]
language: python
notifications:
  irc:
    channels: [irc.freenode.org#searx]
    on_success: change
    template: ['%{repository}/#%{build_number}/%{branch} (%{author}): %{message} %{build_url}']
os: linux
python: '3.6'
script: [./manage.sh styles, ./manage.sh grunt_build, ./manage.sh tests]
sudo: false
