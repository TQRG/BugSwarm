{% extends "student/base.html" %}
{% import 'student/assignment/_tablehelper.html' as table %}
{% import 'student/assignment/_formhelpers.html' as forms %}

{% block title %} Assignment | Ok {% endblock %}

{% block header %}

  <!-- <div class="left col-md-2">
    <div class="stripes">
      <div class="stripe"></div>
      <div class="stripe"></div>
      <div class="stripe"></div>
    </div>
  </div> -->

{% endblock %}

{% block body %}
    <main>
      {% include 'student/assignment/sidebar.html' %}
      <div class="col-md-2"></div>
      <section class="content nomapa col-md-10 col-xs-12">
        <header>
          <div class="header-bg">
            <div class="right col-md-5">
                <a href="{{ url_for('auth.logout') }}" class="header-text"><span>Logout</span></a>
                <div class="header-text user-profile hidden-sm hidden-xs">
                  <span class="user-name"> {{ current_user.name | default(current_user.email, True) }}</span>
                  <i class="fa fa-user"></i>
                </div>
              </div>
          </div>
        </header>

        <div class="subcontent heading">
          <div class="wrap">
            <div class="string-nav">
              <span><a href="{{ url_for('.index', auto_redir=False) }}">Courses</a></span> &raquo;
              <span><a href="{{ url_for('.course', offering=course.offering) }}"> {{ course.display_name }}</a></span> &raquo;
              <span>{{ assignment.display_name }}</span>
            </div>
            <h1>{{ assignment.display_name}}</h1>
          </div>
          {% include 'alerts.html' %}

        </div>


        <div class="subcontent list row">

          <div class="col-md-6 col-sm-12">
            <h2> Group </h2>

            {% include 'student/assignment/group_table.html' %}

          </div>
          <div class="col-md-6 col-sm-12">
            <h2> Current Submission </h2>
            {% if final_submission %}
              <div class="cell col-xs-12">
                <div class="cell-title">
                  <a href="{{ url_for('.code', name=assignment.name, bid=final_submission.id, submit=final_submission.submit)}}" class="due-text green">
                    <time datetime="{{final_submission.created}}"></time>
                  </a>
                </div>
                <div class="cell-text">
                  <span>Submitted by {{ final_submission.submitter.email }}</span>
                </div>
                <div class="cell-text">
                  {% if final_submission.flagged %}
                    <span>Latest Submission. The newest submission will be graded. </span>
                  {% else %}
                    <span>Flagged for Grading. </span>
                  {% endif %}
                </div>
                <div class="cell-status">
                  <span>
                  <a href="{{ url_for('.code', name=assignment.name, bid=final_submission.id, submit=final_submission.submit)}}" class="dashed">
                      View Code
                  </a>
                  </span>
                </div>
              </div>
            {% else %}
              <div class="cell col-xs-12">
                <div class="cell-title">
                  <a class="due-text red"> No Submission </a>
                </div>
                <div class="cell-text">
                  <span> {{ current_user.email }} does not have any submissions for {{ assignment.display_name }} </span>
                </div>
              </div>
            {% endif %}
        </div>
      </div>
        <!-- start desktop/tablet version -->
        <div class="subcontent row hidden-xs hidden-sm">
          <div class="col-md-12">
                       <!-- TODO: Better link to view all backups -->

            {{ table.render_subms(subms, course, flagged, csrf_form, tname="Recent Submissions") }}
            {% if subms %}
            <a href="{{ url_for('.list_backups', name=assignment.name, submit=True) }}" class="no-dash button-large">
                View More Submissions
              </a>
            {% endif %}
          </div>
          <div class="col-md-12">
            {{  table.render_backups(backups, course, tname="Recent Backups") }}
            {% if backups %}
            <a href="{{ url_for('.list_backups', name=assignment.name, submit=False) }}" class="no-dash button-large">
                View More Backups
              </a>
            {% endif %}

          </div>
        </div>
        <!-- start mobile version -->
        {{ table.render_subms_mobile(subms, course, flagged, tname="Recent Submissions") }}
        {{ table.render_backups_mobile(backups, course, tname="Recent Backups") }}

        <!-- end mobile version -->
      </section>
    </main>
{% endblock %}
